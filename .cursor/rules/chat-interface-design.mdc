
# CLI èŠå¤©ç•Œé¢è®¾è®¡è§„èŒƒ (v0.4.0æ›´æ–°)

## ç•Œé¢å¸ƒå±€ç»“æ„
éµå¾ªGemini-CLIçš„ç»å…¸å››å±‚å¸ƒå±€è®¾è®¡ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Header (é¡¶éƒ¨æ¬¢è¿æ¶ˆæ¯)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ MessageHistory (ä¸­é—´æ¶ˆæ¯å†å²)     â”‚
â”‚ ğŸ‘¤ ç”¨æˆ·æ¶ˆæ¯                      â”‚
â”‚ ğŸ¤– ç³»ç»Ÿå›å¤                      â”‚
â”‚ ğŸ”§ å·¥å…·è°ƒç”¨ (v0.4.0æ–°å¢)         â”‚
â”‚ ğŸ“‹ å·¥å…·ç»“æœ (v0.4.0æ–°å¢)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ InputBox (åº•éƒ¨è¾“å…¥æ¡†)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ StatusBar (çŠ¶æ€æ  + å·¥å…·çŠ¶æ€)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ç»„ä»¶è®¾è®¡è§„èŒƒ (v0.4.0æ›´æ–°)

### Headerç»„ä»¶
- ä½¿ç”¨åœ†æ¡†è¾¹æ¡† (`borderStyle="round"`)
- æ˜¾ç¤ºåº”ç”¨åç§°å’Œç‰ˆæœ¬å· (å½“å‰: v0.4.0)
- é¢œè‰²ï¼šcyanï¼ŒåŠ ç²—æ˜¾ç¤º

### MessageHistoryç»„ä»¶ ğŸ†• (v0.4.0å¢å¼º)
#### æ¶ˆæ¯ç±»å‹æ”¯æŒ
- **ç”¨æˆ·æ¶ˆæ¯**ï¼šğŸ‘¤ ç”¨æˆ· (cyané¢œè‰²)
- **AIå›å¤**ï¼šğŸ¤– AI (greené¢œè‰²) 
- **å·¥å…·è°ƒç”¨**ï¼šğŸ”§ å·¥å…·è°ƒç”¨ (yellowé¢œè‰²) ğŸ†•
- **å·¥å…·ç»“æœ**ï¼šğŸ“‹ å·¥å…·ç»“æœ (magentaé¢œè‰²) ğŸ†•

#### å·¥å…·æ¶ˆæ¯æ ¼å¼
```typescript
// å·¥å…·è°ƒç”¨æ¶ˆæ¯ç¤ºä¾‹
const toolCallMessage = {
  type: 'tool-call',
  content: 'è°ƒç”¨å·¥å…·: fileReader\nå‚æ•°: {"filePath": "test.md"}',
  toolName: 'fileReader',
  toolArgs: { filePath: 'test.md' }
};

// å·¥å…·ç»“æœæ¶ˆæ¯ç¤ºä¾‹  
const toolResultMessage = {
  type: 'tool-result',
  content: 'âœ… æˆåŠŸè¯»å–æ–‡ä»¶: test.md\nå†…å®¹é•¿åº¦: 1024 å­—ç¬¦',
  toolName: 'fileReader'
};
```

#### æ¶ˆæ¯æ˜¾ç¤ºé€»è¾‘
```typescript
const getMessageDisplay = (message: Message) => {
  switch (message.type) {
    case 'user':
      return { icon: 'ğŸ‘¤', color: 'cyan', label: 'ç”¨æˆ·' };
    case 'system':
      return { icon: 'ğŸ¤–', color: 'green', label: 'AI' };
    case 'tool-call':      // ğŸ†• v0.4.0
      return { icon: 'ğŸ”§', color: 'yellow', label: 'å·¥å…·è°ƒç”¨' };
    case 'tool-result':    // ğŸ†• v0.4.0
      return { icon: 'ğŸ“‹', color: 'magenta', label: 'å·¥å…·ç»“æœ' };
    default:
      return { icon: 'ğŸ’¬', color: 'gray', label: 'æ¶ˆæ¯' };
  }
};
```

### InputBoxç»„ä»¶
- åœ†æ¡†è¾¹æ¡†åŒ…å›´æ•´ä¸ªè¾“å…¥åŒºåŸŸ
- æç¤ºç¬¦ï¼š`> ` (cyanè‰²åŠ ç²—)
- å…‰æ ‡æŒ‡ç¤ºï¼š`_` (grayè‰²)
- LoadingçŠ¶æ€ï¼šæ˜¾ç¤º"(æ­£åœ¨å¤„ç†...)"

### StatusBarç»„ä»¶ ğŸ†• (v0.4.0å¢å¼º)
- **é”™è¯¯æ˜¾ç¤º**ï¼šâŒ + redé¢œè‰²
- **å·¥å…·çŠ¶æ€æ˜¾ç¤º**ï¼šå®æ—¶æ˜¾ç¤ºå·¥å…·æ‰§è¡Œè¿›åº¦ ğŸ†•
  - "æ­£åœ¨è¯»å–æ–‡ä»¶: example.md"
  - "æ­£åœ¨æŠ“å–ç½‘é¡µ: https://example.com"
  - "æ–‡ä»¶è¯»å–å®Œæˆ"
- **é»˜è®¤æç¤º**ï¼š"å‡†å¤‡å°±ç»ª - è¾“å…¥æ¶ˆæ¯å¹¶æŒ‰å›è½¦å‘é€"

## äº¤äº’æµç¨‹è®¾è®¡ (v0.4.0æ›´æ–°)

### æ¶ˆæ¯å¤„ç†æµç¨‹
1. **ç”¨æˆ·è¾“å…¥** â†’ æ£€æŸ¥éç©º â†’ æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
2. **è®¾ç½®Loading** â†’ æ›´æ–°çŠ¶æ€æ  â†’ æ˜¾ç¤º"æ­£åœ¨ä¸AIå¯¹è¯..."
3. **å·¥å…·è°ƒç”¨é˜¶æ®µ** ğŸ†• â†’ å®æ—¶çŠ¶æ€æ›´æ–° â†’ è®°å½•å·¥å…·æ¶ˆæ¯
   - å·¥å…·è°ƒç”¨å¼€å§‹ â†’ æ·»åŠ å·¥å…·è°ƒç”¨æ¶ˆæ¯
   - å·¥å…·æ‰§è¡Œè¿‡ç¨‹ â†’ çŠ¶æ€æ æ˜¾ç¤ºè¿›åº¦
   - å·¥å…·æ‰§è¡Œå®Œæˆ â†’ æ·»åŠ å·¥å…·ç»“æœæ¶ˆæ¯
4. **AIå›å¤** â†’ æ·»åŠ ç³»ç»Ÿå›å¤ â†’ å®ŒæˆçŠ¶æ€

### å·¥å…·è°ƒç”¨å›è°ƒå¤„ç† ğŸ†• (v0.4.0)
```typescript
const toolCallbacks: ToolCallbacks = {
  onStatusUpdate: (status: string) => {
    // å®æ—¶æ›´æ–°çŠ¶æ€æ 
    setAppState(prev => ({ ...prev, statusMessage: status }));
  },
  onToolCall: (toolName: string, args: any) => {
    // æ·»åŠ å·¥å…·è°ƒç”¨æ¶ˆæ¯åˆ°å†å²
    const argsStr = JSON.stringify(args, null, 2);
    addMessage(`è°ƒç”¨å·¥å…·: ${toolName}\nå‚æ•°: ${argsStr}`, 'tool-call', toolName, args);
  },
  onToolResult: (toolName: string, result: any) => {
    // æ·»åŠ å·¥å…·ç»“æœæ¶ˆæ¯åˆ°å†å²
    const resultStr = formatToolResult(result);
    addMessage(resultStr, 'tool-result', toolName);
  }
};
```

### é”®ç›˜äº‹ä»¶å¤„ç†
- **Enteré”®**ï¼šæäº¤æ¶ˆæ¯ (ä»…å½“è¾“å…¥éç©ºæ—¶)
- **Backspaceé”®**ï¼šåˆ é™¤å­—ç¬¦ + æ›´æ–°å…‰æ ‡ä½ç½®
- **æ™®é€šè¾“å…¥**ï¼šè¿½åŠ å­—ç¬¦ + æ›´æ–°å…‰æ ‡ä½ç½®
- **LoadingæœŸé—´**ï¼šç¦ç”¨æ‰€æœ‰è¾“å…¥

## çŠ¶æ€ç®¡ç†æ¨¡å¼ (v0.4.0æ›´æ–°)

### AppStateæ¥å£è®¾è®¡
```typescript
interface AppState {
  messages: Message[];      // æ¶ˆæ¯å†å² (åŒ…å«å·¥å…·æ¶ˆæ¯)
  currentInput: string;     // å½“å‰è¾“å…¥ (å·²åºŸå¼ƒï¼Œç”±InputBoxå†…éƒ¨ç®¡ç†)
  isLoading: boolean;       // åŠ è½½çŠ¶æ€
  statusMessage: string;    // çŠ¶æ€æ¶ˆæ¯ (åŒ…å«å·¥å…·çŠ¶æ€)
  error?: string;          // é”™è¯¯ä¿¡æ¯
}
```

### Messageæ¥å£è®¾è®¡ ğŸ†• (v0.4.0æ‰©å±•)
```typescript
interface Message {
  id: string;                              // å”¯ä¸€æ ‡è¯† (ä½¿ç”¨æ—¶é—´æˆ³)
  content: string;                         // æ¶ˆæ¯å†…å®¹
  timestamp: Date;                         // å‘é€æ—¶é—´
  type: 'user' | 'system' | 'tool-call' | 'tool-result';  // ğŸ†• æ‰©å±•æ¶ˆæ¯ç±»å‹
  toolName?: string;                       // ğŸ†• å·¥å…·åç§°
  toolArgs?: Record<string, any>;          // ğŸ†• å·¥å…·å‚æ•°
}
```

### æ¶ˆæ¯å†å²è¿‡æ»¤ ğŸ†• (v0.4.0æ–°å¢)
```typescript
// ä¸ºAIå¯¹è¯å‡†å¤‡æ¶ˆæ¯å†å²æ—¶ï¼Œè¿‡æ»¤æ‰å·¥å…·æ¶ˆæ¯
const chatHistory: ChatMessage[] = [
  ...appState.messages
    .filter(msg => msg.type === 'user' || msg.type === 'system') // åªåŒ…å«å¯¹è¯æ¶ˆæ¯
    .map(msg => ({
      role: msg.type === 'user' ? 'user' as const : 'assistant' as const,
      content: msg.content
    }))
];
```

## è§†è§‰è®¾è®¡åŸåˆ™ (v0.4.0æ›´æ–°)
- **ä¸€è‡´æ€§**ï¼šæ‰€æœ‰è¾¹æ¡†ä½¿ç”¨ç›¸åŒçš„cyanè‰²è°ƒ
- **å±‚æ¬¡æ„Ÿ**ï¼šé€šè¿‡é¢œè‰²å’Œå›¾æ ‡åŒºåˆ†ä¸åŒç±»å‹æ¶ˆæ¯
  - ç”¨æˆ·æ¶ˆæ¯ï¼šcyan (ğŸ‘¤)
  - AIå›å¤ï¼šgreen (ğŸ¤–)  
  - å·¥å…·è°ƒç”¨ï¼šyellow (ğŸ”§) ğŸ†•
  - å·¥å…·ç»“æœï¼šmagenta (ğŸ“‹) ğŸ†•
- **åé¦ˆæ€§**ï¼šLoadingçŠ¶æ€ã€å·¥å…·çŠ¶æ€å’Œé”™è¯¯çŠ¶æ€æœ‰æ˜ç¡®è§†è§‰æŒ‡ç¤º
- **é€æ˜æ€§**ï¼šå·¥å…·è°ƒç”¨è¿‡ç¨‹å®Œå…¨å¯è§ï¼Œæå‡ç”¨æˆ·ä½“éªŒ ğŸ†•
- **ç®€æ´æ€§**ï¼šé¿å…è¿‡å¤šè£…é¥°ï¼Œä¿æŒç»ˆç«¯ç•Œé¢çš„ç®€æ´ç¾è§‚
